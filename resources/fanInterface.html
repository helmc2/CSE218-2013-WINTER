<!DOCTYPE HTML>
<html>
<head>
<script src="http://code.jquery.com/jquery-1.9.0.min.js"></script>
<script src="epochUtils.js"></script>
<title>Hockey Game Manager</title>
<meta charset="UTF-8" />
<link rel="stylesheet" type="text/css" href="reset.css">
<link rel="stylesheet" type="text/css" href="fan_interface_structure.css">

<script>
var games_ids = {};

$(document).ready(function() {
  	$("#show-event").click(function() {
		source = document.getElementById('selectGame');
		
		for(var i=(source.options.length-1); i>=0; i--){
			if(source.options[i].selected){		
				$.getJSON("/games/"+games_ids[source.options[i].text]+"/events", function(data,status) 
				{		
					target = document.getElementById('event-box');
					if (data["events"].length == 0)
						target.value = "NO EVENTS :(";
				});		  	
			}	
		}
  	});
});	

window.onload=function() {
	// Populate DOMs
	$.getJSON("/games", function(data,status) 
	{		
		target = document.getElementById('selectGame');
   				
		for (var i = 0; i < data["data"].length; i++) { 
			var dom_txt = data["data"][i]["away"] + " @ " + data["data"][i]["home"] + " (" + EpochToDate(data["data"][i]["scheduled"]) + ")";
			games_ids[dom_txt] = data["data"][i]["id"];
			target.options[target.options.length]=new Option(dom_txt);
		}      
    });	
};
</script>

</head>

<body>
<div class="box panel" action="/openid" method="POST">
	<fieldset class="boxBody">
	  <label>Fan Interface</label>	  
	</fieldset>
    
	<content>	  
            <td align="left">Games:</td> </br>
            <td align="left"><select name="selectGame" id="selectGame" style="width: 600px;">
            </select></td>
            <button type="submit" id="show-event" class="btn" style="visibility: visible">Update</button>
        	</br> 
            <textarea readonly id="event-box" rows="4" style="width: 940px; height: 450px; margin-top: 10px; resize: none;">
            </textarea>          
	</content>
    
</div>
<footer id="main">
  Hockey Game Manager | CSE 218
</footer>

    <div id="content"></div>

</body>
</html>
